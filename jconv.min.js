(()=>{var I="ãƒ»".charCodeAt(0),d={SJIS:require("./tables/SJIS"),JIS:require("./tables/JIS"),JISEXT:require("./tables/JISEXT"),SJISInverted:require("./tables/SJISInverted"),JISInverted:require("./tables/JISInverted"),JISEXTInverted:require("./tables/JISEXTInverted")},a={},c=module.exports=function(e,n,r){return c.convert(e,n,r)};function t(e){switch(e.toUpperCase()){case"WINDOWS-31J":case"CP932":case"SJIS":case"SHIFTJIS":case"SHIFT_JIS":return"SJIS";case"EUCJP":case"EUC-JP":return"EUCJP";case"JIS":case"ISO2022JP":case"ISO-2022-JP":case"ISO-2022-JP-1":return"JIS";case"UTF8":case"UTF-8":return"UTF8";case"UNICODE":case"UCS2":case"UCS-2":case"UTF16LE":case"UTF-16LE":return"UCS2";default:return""}}function J(e,n,r){return e<128?n[r++]=e:(e<2048?n[r++]=192|e>>>6:(e<65536?n[r++]=224|e>>>12:(e<2097152?n[r++]=240|e>>>18:(e<67108864?n[r++]=248|e>>>24:(n[r++]=252|e/1073741824,n[r++]=128|e>>>24&63),n[r++]=128|e>>>18&63),n[r++]=128|e>>>12&63),n[r++]=128|e>>>6&63),n[r++]=128|63&e),r}function l(e,n,r){return n[r++]=255&e,n[r++]=e>>8,r}c.defineEncoding=function(e){a[e.name]=new function(e){this.name=e.name,this.convert=e.convert}(e)},c.convert=function(e,n,r){if(n=t(n),r=t(r),n&&r){if(e=(c=(c=e)||new Buffer(0))instanceof Buffer?c:new Buffer(c.toString(),"UTF8"),n===r)return e;var c=a[n+"to"+r];if(c)return c.convert(e);c=a[n+"toUCS2"],n=a["UCS2to"+r];if(c&&n)return n.convert(c.convert(e))}throw new Error("Encoding not recognized.")},c.decode=function(e,n){switch(n.toUpperCase()){case"BINARY":case"BASE64":case"ASCII":case"HEX":case"UTF8":case"UTF-8":case"UNICODE":case"UCS2":case"UCS-2":case"UTF16LE":case"UTF-16LE":return e.toString(n);default:return c.convert(e,n,"UCS2").toString("UCS2")}},c.encode=function(e,n){switch(n.toUpperCase()){case"BASE64":case"ASCII":case"HEX":case"UTF8":case"UTF-8":return new Buffer(e,n);default:return c.convert(e,"UTF8",n)}},c.encodingExists=function(e){return!!t(e)},c.defineEncoding({name:"UCS2toUTF8",convert:function(e){for(var n=J,r=e.length,c=new Buffer(3*r),a=0,t=0;t<r;)var s=e[t++],a=n((e[t++]<<8)+s,c,a);return c.slice(0,a)}}),c.defineEncoding({name:"UCS2toSJIS",convert:function(e){for(var n=d.SJISInverted,r=n[I],c=e.length,a=new Buffer(c),t=0,s=0;s<c;){var o=e[s++];(o=(e[s++]<<8)+o)<128?a[t++]=o:65377<=o&&o<=65439?a[t++]=o-65216:(o=n[o]||r,a[t++]=o>>8,a[t++]=255&o)}return a.slice(0,t)}}),c.defineEncoding({name:"UCS2toJIS",convert:function(e){for(var n=d.JISInverted,r=d.JISEXTInverted,c=n[I],a=e.length,t=new Buffer(3*a+4),s=0,o=0,f=0;f<a;){var i,S=e[f++];(S=(e[f++]<<8)+S)<128?(0!==o&&(o=0,t[s++]=27,t[s++]=40,t[s++]=66),t[s++]=S):65377<=S&&S<=65439?(1!==o&&(o=1,t[s++]=27,t[s++]=40,t[s++]=73),t[s++]=S-65344):(i=n[S])?(2!==o&&(o=2,t[s++]=27,t[s++]=36,t[s++]=66),t[s++]=i>>8,t[s++]=255&i):(i=r[S])?(3!==o&&(o=3,t[s++]=27,t[s++]=36,t[s++]=40,t[s++]=68),t[s++]=i>>8,t[s++]=255&i):(2!==o&&(o=2,t[s++]=27,t[s++]=36,t[s++]=66),t[s++]=c>>8,t[s++]=255&c)}return 0!==o&&(o=0,t[s++]=27,t[s++]=40,t[s++]=66),t.slice(0,s)}}),c.defineEncoding({name:"UCS2toEUCJP",convert:function(e){for(var n=d.JISInverted,r=d.JISEXTInverted,c=n[I],a=e.length,t=new Buffer(2*a),s=0,o=0;o<a;){var f,i=e[o++];(i=(e[o++]<<8)+i)<128?t[s++]=i:65377<=i&&i<=65439?(t[s++]=142,t[s++]=i-65472):(f=n[i])?(t[s++]=(f>>8)-128,t[s++]=(255&f)-128):(f=r[i])?(t[s++]=143,t[s++]=(f>>8)-128,t[s++]=(255&f)-128):(t[s++]=(c>>8)-128,t[s++]=(255&c)-128)}return t.slice(0,s)}}),c.defineEncoding({name:"UTF8toUCS2",convert:function(e){for(var n,r=l,c=e.length,a=new Buffer(2*c),t=0,s=0;s<c;){var o=e[s++];switch(o>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n=o;break;case 12:case 13:n=(31&o)<<6|63&e[s++];break;case 14:n=(15&o)<<12|(63&e[s++])<<6|63&e[s++];break;default:n=(7&o)<<18|(63&e[s++])<<12|(63&e[s++])<<6|63&e[s++]}t=r(n,a,t)}return a.slice(0,t)}}),c.defineEncoding({name:"UTF8toSJIS",convert:function(e){for(var n,r=d.SJISInverted,c=r[I],a=e.length,t=new Buffer(2*a),s=0,o=0;o<a;){var f,i=e[o++];switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n=i;break;case 12:case 13:n=(31&i)<<6|63&e[o++];break;case 14:n=(15&i)<<12|(63&e[o++])<<6|63&e[o++];break;default:n=(7&i)<<18|(63&e[o++])<<12|(63&e[o++])<<6|63&e[o++]}n<128?t[s++]=n:65377<=n&&n<=65439?t[s++]=n-65216:(f=r[n]||c,t[s++]=f>>8,t[s++]=255&f)}return t.slice(0,s)}}),c.defineEncoding({name:"UTF8toJIS",convert:function(e){for(var n,r=d.JISInverted,c=d.JISEXTInverted,a=r[I],t=e.length,s=new Buffer(3*t+4),o=0,f=0,i=0;i<t;){var S,u=e[i++];switch(u>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n=u;break;case 12:case 13:n=(31&u)<<6|63&e[i++];break;case 14:n=(15&u)<<12|(63&e[i++])<<6|63&e[i++];break;default:n=(7&u)<<18|(63&e[i++])<<12|(63&e[i++])<<6|63&e[i++]}n<128?(0!==f&&(f=0,s[o++]=27,s[o++]=40,s[o++]=66),s[o++]=n):65377<=n&&n<=65439?(1!==f&&(f=1,s[o++]=27,s[o++]=40,s[o++]=73),s[o++]=n-65344):(S=r[n])?(2!==f&&(f=2,s[o++]=27,s[o++]=36,s[o++]=66),s[o++]=S>>8,s[o++]=255&S):(S=c[n])?(3!==f&&(f=3,s[o++]=27,s[o++]=36,s[o++]=40,s[o++]=68),s[o++]=S>>8,s[o++]=255&S):(2!==f&&(f=2,s[o++]=27,s[o++]=36,s[o++]=66),s[o++]=a>>8,s[o++]=255&a)}return 0!==f&&(f=0,s[o++]=27,s[o++]=40,s[o++]=66),s.slice(0,o)}}),c.defineEncoding({name:"UTF8toEUCJP",convert:function(e){for(var n,r=d.JISInverted,c=d.JISEXTInverted,a=r[I],t=e.length,s=new Buffer(2*t),o=0,f=0;f<t;){var i,S=e[f++];switch(S>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n=S;break;case 12:case 13:n=(31&S)<<6|63&e[f++];break;case 14:n=(15&S)<<12|(63&e[f++])<<6|63&e[f++];break;default:n=(7&S)<<18|(63&e[f++])<<12|(63&e[f++])<<6|63&e[f++]}n<128?s[o++]=n:65377<=n&&n<=65439?(s[o++]=142,s[o++]=n-65472):(i=r[n])?(s[o++]=(i>>8)-128,s[o++]=(255&i)-128):(i=c[n])?(s[o++]=143,s[o++]=(i>>8)-128,s[o++]=(255&i)-128):(s[o++]=(a>>8)-128,s[o++]=(255&a)-128)}return s.slice(0,o)}}),c.defineEncoding({name:"SJIStoUCS2",convert:function(e){for(var n=d.SJIS,r=l,c=e.length,a=new Buffer(3*c),t=0,s=0;s<c;)var o=e[s++],t=r(o<128?o:160<=o&&o<=223?o+65216:n[(o<<8)+e[s++]]||I,a,t);return a.slice(0,t)}}),c.defineEncoding({name:"SJIStoUTF8",convert:function(e){for(var n=d.SJIS,r=J,c=e.length,a=new Buffer(3*c),t=0,s=0;s<c;)var o=e[s++],t=r(o<128?o:160<=o&&o<=223?o+65216:n[(o<<8)+e[s++]]||I,a,t);return a.slice(0,t)}}),c.defineEncoding({name:"SJIStoJIS",convert:function(e){for(var n=d.SJIS,r=d.JISInverted,c=e.length,a=new Buffer(3*c+4),t=0,s=0,o=0;o<c;){var f,i=e[o++];i<128?(0!==s&&(s=0,a[t++]=27,a[t++]=40,a[t++]=66),a[t++]=i):161<=i&&i<=223?(1!==s&&(s=1,a[t++]=27,a[t++]=40,a[t++]=73),a[t++]=i-128):i<=238?(2!==s&&(s=2,a[t++]=27,a[t++]=36,a[t++]=66),i<<=1,(f=e[o++])<159?(i-=i<319?225:97,f-=126<f?32:31):(i-=i<319?224:96,f-=126),a[t++]=i,a[t++]=f):250<=i&&(2!==s&&(s=2,a[t++]=27,a[t++]=36,a[t++]=66),f=r[n[(i<<8)+e[o++]]||I],a[t++]=f>>8,a[t++]=255&f)}return 0!==s&&(s=0,a[t++]=27,a[t++]=40,a[t++]=66),a.slice(0,t)}}),c.defineEncoding({name:"SJIStoEUCJP",convert:function(e){for(var n=d.SJIS,r=d.JISInverted,c=e.length,a=new Buffer(2*c),t=0,s=0;s<c;){var o,f=e[s++];f<128?a[t++]=f:161<=f&&f<=223?(a[t++]=142,a[t++]=f):f<=238?(f<<=1,(o=e[s++])<159?(f-=f<319?97:225,o+=126<o?96:97):(f-=f<319?96:224,o+=2),a[t++]=f,a[t++]=o):250<=f&&(o=r[n[(f<<8)+e[s++]]||I],a[t++]=(o>>8)-128,a[t++]=(255&o)-128)}return a.slice(0,t)}}),c.defineEncoding({name:"JIStoUCS2",convert:function(e){for(var n=d.JIS,r=d.JISEXT,c=l,a=e.length,t=new Buffer(2*a),s=0,o=0,f=0;f<a;){var i=e[f++];if(27===i){var S=e[f++],u=e[f++];switch(S){case 40:66===u||74===u?o=0:73===u&&(o=1);break;case 38:o=2,f+=3;break;case 36:64===u||66===u?o=2:40===u&&(o=3,f++)}}else{switch(o){case 0:v=i;break;case 1:v=i+65344;break;case 2:var v=n[(i<<8)+e[f++]]||I;break;case 3:v=r[(i<<8)+e[f++]]||I}s=c(v,t,s)}}return t.slice(0,s)}}),c.defineEncoding({name:"JIStoUTF8",convert:function(e){for(var n=d.JIS,r=d.JISEXT,c=J,a=e.length,t=new Buffer(2*a),s=0,o=0,f=0;f<a;){var i=e[f++];if(27===i){var S=e[f++],u=e[f++];switch(S){case 40:66===u||74===u?o=0:73===u&&(o=1);break;case 38:o=2,f+=3;break;case 36:64===u||66===u?o=2:40===u&&(o=3,f++)}}else{switch(o){case 0:v=i;break;case 1:v=i+65344;break;case 2:var v=n[(i<<8)+e[f++]]||I;break;case 3:v=r[(i<<8)+e[f++]]||I}s=c(v,t,s)}}return t.slice(0,s)}}),c.defineEncoding({name:"JIStoSJIS",convert:function(e){for(var n=d.SJIS,r=d.SJISInverted,c=r[I],a=e.length,t=new Buffer(2*a),s=0,o=0,f=0;f<a;)if(27===(u=e[f++])){var i=e[f++],S=e[f++];switch(i){case 40:66===S||74===S?o=0:73===S&&(o=1);break;case 38:o=2,f+=3;break;case 36:64===S||66===S?o=2:40===S&&(o=3,f++)}}else switch(o){case 0:t[s++]=u;break;case 1:t[s++]=u+128;break;case 2:var u,i=e[f++],v=(1&u?((u>>=1)<47?u+=113:u-=79,i+=95<i?32:31):((u>>=1)<=47?u+=112:u-=80,i+=126),((255&u)<<8)+i);60736<=v&&v<=61180&&(u=(v=r[n[v]]||c)>>8,i=255&v),t[s++]=u,t[s++]=i;break;case 3:t[s++]=c>>8,t[s++]=255&c,f++}return t.slice(0,s)}}),c.defineEncoding({name:"JIStoEUCJP",convert:function(e){for(var n=e.length,r=new Buffer(2*n),c=0,a=0,t=0;t<n;){var s=e[t++];if(27===s){var o=e[t++],f=e[t++];switch(o){case 40:66===f||74===f?a=0:73===f&&(a=1);break;case 38:a=2,t+=3;break;case 36:64===f||66===f?a=2:40===f&&(a=3,t++)}}else switch(a){case 0:r[c++]=s;break;case 1:r[c++]=142,r[c++]=s+128;break;case 2:r[c++]=s+128,r[c++]=e[t++]+128;break;case 3:r[c++]=143,r[c++]=s+128,r[c++]=e[t++]+128}}return r.slice(0,c)}}),c.defineEncoding({name:"EUCJPtoUCS2",convert:function(e){for(var n=d.JIS,r=d.JISEXT,c=l,a=e.length,t=new Buffer(2*a),s=0,o=0;o<a;)var f=e[o++],s=c(f<128?f:142===f?e[o++]+65216:143===f?r[(e[o++]-128<<8)+(e[o++]-128)]||I:n[(f-128<<8)+(e[o++]-128)]||I,t,s);return t.slice(0,s)}}),c.defineEncoding({name:"EUCJPtoUTF8",convert:function(e){for(var n=d.JIS,r=d.JISEXT,c=J,a=e.length,t=new Buffer(2*a),s=0,o=0;o<a;)var f=e[o++],s=c(f<128?f:142===f?e[o++]+65216:143===f?r[(e[o++]-128<<8)+(e[o++]-128)]||I:n[(f-128<<8)+(e[o++]-128)]||I,t,s);return t.slice(0,s)}}),c.defineEncoding({name:"EUCJPtoSJIS",convert:function(e){for(var n=d.SJIS,r=d.SJISInverted,c=r[I],a=e.length,t=new Buffer(2*a),s=0,o=0;o<a;){var f,i,S=e[o++];S<128?t[s++]=S:142===S?t[s++]=e[o++]:143===S?(t[s++]=c>>8,t[s++]=255&c,o+=2):(i=e[o++],1&S?(S=(S>>=1)+(S<111?49:113),i-=223<i?96:97):(S=(S>>=1)+(S<=111?48:112),i-=2),60736<=(f=((255&S)<<8)+i)&&f<=61180&&(S=(f=r[n[f]]||c)>>8,i=255&f),t[s++]=S,t[s++]=i)}return t.slice(0,s)}}),c.defineEncoding({name:"EUCJPtoJIS",convert:function(e){for(var n=e.length,r=new Buffer(3*n+4),c=0,a=0,t=0;t<n;){var s=e[t++];s<128?(0!==a&&(a=0,r[c++]=27,r[c++]=40,r[c++]=66),r[c++]=s):(142===s?1!==a&&(a=1,r[c++]=27,r[c++]=40,r[c++]=73):143===s?(3!==a&&(a=3,r[c++]=27,r[c++]=36,r[c++]=40,r[c++]=68),r[c++]=e[t++]-128):(2!==a&&(a=2,r[c++]=27,r[c++]=36,r[c++]=66),r[c++]=s-128),r[c++]=e[t++]-128)}return 0!==a&&(a=0,r[c++]=27,r[c++]=40,r[c++]=66),r.slice(0,c)}})})();